---
version: '3'
includes:
  pip:
    internal: true
    taskfile: python-pip.yml
tasks:
  default:
    cmds:
      - task: pip:install
        vars:
          u: "true"
          pkg: pipenv
  install:
    vars:
      workdir: '{{ .workdir | default .USER_WORKING_DIR }}'
      r: '{{ .r | default .requirements | default "requirements.txt" }}'
    cmds:
      - |
        {{- if .workdir }}
        cd {{ .workdir | quote }}
        {{- end }}
        if [ -e {{ .r | quote }} ];
        then
          pipenv install -r {{ .r | quote }}
        fi
  run-python:
    vars:
      workdir: '{{ .workdir | default .USER_WORKING_DIR }}'
      t: '{{ .t | default .target | default "main.py" }}'
    cmds:
      - |
        {{- if .workdir }}
        cd {{ .workdir }}
        {{- end }}
        if [ -e {{ .t | quote }} ];
        then
          pipenv run python {{ .t | quote }}
        fi
