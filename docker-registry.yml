---
version: '3'
includes:
  docker-daemon: docker-daemon.yml
tasks:
  default:
    deps:
      - apply
  apply:
    vars:
      name: '{{ .name | default "kind-registry" }}'
      image: '{{ .image | default "registry:2" }}'
      registry_proxy_remote_url: '{{ .registry_proxy_remote_url | default "https://registry-1.docker.io" }}'
    cmds:
      - task: docker-daemon:apply
        vars:
          name: '{{ .name }}'
          args: >-
            -e REGISTRY_PROXY_REMOTEURL={{ .registry_proxy_remote_url }}
          image: '{{ .image }}'
  delete:
    vars:
      name: '{{ .name | default "kind-registry" }}'
    cmds:
      - task: docker-daemon:delete
        vars:
          name: '{{ .name }}'
