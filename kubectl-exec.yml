---
version: '3'
tasks:
  default:
    vars:
      selector: '{{ .selector }}'
      c: '{{ .c | default .container }}'
      f: '{{ .f | default .filename }}'
      pod_running_timeout: '{{ .pod_running_timeout }}'
      q: '{{ .q | default .quiet | default "false" }}'
      i: '{{ .i | default .stdin | default "false" }}'
      t: '{{ .t | default .tty | default "false" }}'
      n: '{{ .n | default .namespace }}'
      ke_cmd: '{{ .ke_cmd }}'
      ke_args: '{{ .ke_args }}'
      output: '{{ .output }}'
    cmds:
      - |
        kubectl exec \
          -n {{ .n | quote }}
          {{- if .c }} \
          -c={{ .c | quote }}
          {{- end }}
          {{- if .f }} \
          -f={{ .f | quote }}
          {{- end }}
          {{- if .pod_running_timeout }} \
          --pod-running-timeout={{ .pod_running_timeout | quote }}
          {{- end }}
          {{- if eq "true" .q }} \
          -q
          {{- end }}
          {{- if eq "true" .i }} \
          -i
          {{- end }}
          {{- if eq "true" .t }} \
          -t
          {{- end }} \
          {{ .selector | quote }} \
          -- \
          {{ .ke_cmd | quote }}
          {{- if .ke_args }} \
          {{ .ke_args }}
          {{- end }}
          {{- if .output }} > {{ .output | quote }}
          {{- end }}
